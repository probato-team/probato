name: Deploy artifacts to Maven Central

on:
   push:
     branches:
       - main
       - deploy
       - 'feature/**'

jobs:
   deploy:
      runs-on: ubuntu-latest
      steps:
         - uses: actions/checkout@v4
         - name: Set up Maven Central Repository
           uses: actions/setup-java@v4
           with:
             java-version: '11'
             distribution: 'temurin'
             server-id: central
             server-username: MAVEN_USERNAME
             server-password: MAVEN_PASSWORD
             gpg-private-key: ${{ secrets.GPG_PRIVATE_KEY }}
             gpg-passphrase: MAVEN_GPG_PASSPHRASE
         - name: Set version
           run: mvn versions:set -DnewVersion=0.0.0
         - name: Publish package
           run: mvn -e --batch-mode deploy -DskipTests -Dworkflow=Github
           env:
             MAVEN_USERNAME: ${{ secrets.OSSRH_USERNAME }}
             MAVEN_PASSWORD: ${{ secrets.OSSRH_PASSWORD }}
             MAVEN_GPG_PASSPHRASE: ${{ secrets.GPG_PASSPHRASE }}
